YUI.add("gallery-file-uploader",function(e,t){var n={},r={};r.autoUpload={value:1},n.initializer=function(e){if(!e||!e.container){alert("[yFileUploader] Missing conatiner");return}this.set("container",e.container),e.progressBarWidth?this.set("progressBarWidth",e.progressBarWidth):this.set("progressBarWidth",500),e.progressBarHeight?this.set("progressBarHeight",e.progressBarHeight):this.set("progressBarHeight",20),e.progressBarContainer&&this.set("progressBarContainer",e.progressBarContainer),this.after("fileselect",this.fileSelectedTrigger,this),this.after("uploadstart",this.fileUploadStartTrigger,this),this.after("uploadprogress",this.fileUploadProgressTrigger,this),this.after("uploadcomplete",this.fileUploadCompleteTrigger,this),this.after("uploaderror",this.fileUploadErrorTrigger,this)},n.fileSelected=function(){},n.fileUpload=function(e){try{this.upload(e,this.get("uploadUrl"),this.get("param"))}catch(t){}},n.renderFileUploadStart=function(e){var t="";if(!e||!e.container)t=this.get("container")},n.renderFileUploadComplete=function(t){var n="",r=e.one("#"+this.barId);r&&r.remove(),this.barId=""},n.renderProgressBar=function(t){var n=this.get("progressBarWidth"),r=this.get("progressBarHeight"),i=Math.floor(n*t.percentLoaded/100),s=this.get("container");this.barId&&e.one("#"+this.barId)&&e.one("#"+this.barId).remove();var o=document.createElement("div"),u=document.createElement("div");o.innerHTML=Math.floor(t.percentLoaded)+" %",e.one(o).setStyles({border:"1px solid black",height:r+"px",width:n+"px","text-align":"right",position:"relative"}),e.one(u).setStyles({background:"#2f2f2f",border:"1px solid black",height:r+"px",width:i+"px",position:"absolute",top:"0px",left:"0px"}),o.appendChild(u),this.barId=e.one(o).generateID(),this.get("progressBarContainer")?(e.one(this.get("progressBarContainer")).setHTML(""),e.one(this.get("progressBarContainer")).appendChild(o)):e.one(s).append(o)},n.renderFileUploadError=function(t){var n=document.createElement("div"),r=this.get("container");this.barId&&e.one("#"+this.barId)&&e.one("#"+this.barId).remove(),n.innerHTML="\u4e0a\u50b3\u5931\u6557\uff0c\u53ef\u80fd\u539f\u56e0\uff1a\u6a94\u6848 Size \u8d85\u904e\u4e0a\u9650 2 MB ..",e.one(n).setStyles({color:"#a00"}),this.barId=e.one(n).generateID(),e.one(r).append(n)},n.fileSelectedTrigger=function(e){var t=this.get("autoUpload");if(!e.fileList||e.fileList.length<1)return;var n=e.fileList.length,r,i=0;if(t)for(i=0;i<n;i++)r=e.fileList[i],this.fileUpload(r);else this.fileSelected();e.preventDefault(),e.stopPropagation()},n.fileUploadStartTrigger=function(e){this.renderFileUploadStart(),e.preventDefault(),e.stopPropagation()},n.fileUploadErrorTrigger=function(e){var t=e.message,n=e.status;this.renderFileUploadError({status:n,msg:t}),e.preventDefault(),e.stopPropagation()},n.fileUploadProgressTrigger=function(e){var t={percentLoaded:e.percentLoaded};this.renderProgressBar(t),e.preventDefault(),e.stopPropagation()},n.fileUploadCompleteTrigger=function(e){var t={percentLoaded:e.percentLoaded,response:e.data};this.renderFileUploadComplete(t),e.preventDefault(),e.stopPropagation()},e.yFileUploader=e.Base.create("yFileUploader",e.Uploader,[],n,{ATTRS:r})},"@VERSION@",{requires:["uploader"]});
